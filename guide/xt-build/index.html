<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="@mobilefirstllc">
  <link rel="canonical" href="https://oss.mobilefirst.me/extension-cli/guide/xt-build/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>xt-build - Extension CLI // Guide</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "xt-build";
    var mkdocs_page_input_path = "guide/xt-build.md";
    var mkdocs_page_url = "/extension-cli/guide/xt-build/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-129118591-7', 'extension-cli');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Extension CLI // Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Setup</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../getting-started/">★ Getting Started</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../configuration/">Configuration</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Commands</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">xt-build</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#dev-build-artifacts">Dev Build Artifacts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prod-build-artifacts">Prod Build Artifacts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#commands">Commands</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#build-configuration">Build Configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#custom-configurations">Custom Configurations</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#script-bundles">Script Bundles</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#skip-javascript-compilation-and-linting">Skip Javascript Compilation and Linting</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example_1">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#style-bundles">Style bundles</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example_2">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#localization">Localization</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example_3">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#image-assets">Image Assets</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../xt-clean/">xt-clean</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../xt-test/">xt-test</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../xt-docs/">xt-docs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../xt-sync/">xt-sync</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../xt-create/">xt-create</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Useful Resources</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../release-notes/">Release Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../showcase/">Showcase</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../helpful/">Helpful References</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Source Code</span></p>
                <ul>
                    <li class="toctree-l1"><a class="" href="https://github.com/MobileFirstLLC/extension-cli">Github Repo</a>
                    </li>
                    <li class="toctree-l1"><a class="" href="https://www.npmjs.com/package/extension-cli">@ NPM.org</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Extension CLI // Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Commands &raquo;</li>
        
      
    
    <li>xt-build</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/MobileFirstLLC/extension-cli/blob/master/guide/guide/xt-build.md"
          class="icon icon-github"> Edit on Github</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="xt-build">xt-build</h1>
<hr />
<p style='font-size:1.3em;line-height:1.7;'><code>xt-build</code> command is used for generating a debuggable dev version of an extension project. It is also used to create a production ready, minified .zip file that can be uploaded to the chrome web store.</p>

<hr />
<p>Successful build command always generates an extension <code>dist/</code> directory that can be debugged in the browser.  The underlying build system
uses <a href="https://github.com/gulpjs/gulp">gulp</a>, <a href="https://github.com/babel/gulp-babel">babel</a> and <a href="https://github.com/webpack/webpack">webpack</a> to compile scripts (among other plugins).</p>
<h3 id="dev-build-artifacts">Dev Build Artifacts</h3>
<p>When specifying<code>dev</code> build flag, the build will complete using development settings. The output of a successful dev build is  a <code>dist/</code> directory which can be debugged using the chrome browser. The build command will always compile scripts using production settings, because extension scripts must be compiled prior to debugging (<code>eval</code> is not allowed).</p>
<h3 id="prod-build-artifacts">Prod Build Artifacts</h3>
<p>When specifying <code>prod</code> build flag, the build will run a production build. Successful production build will generate a <code>dist/</code> directory of extension files which can be debugged in the browser. It will also generate a <code>release.zip</code> file in the project root strictly based on the files in the <code>dist</code> directory. This zip file can be uploaded directly to the Chrome Web Store. When running a production build, all code files (js, sass, html, json) will be minified.</p>
<h2 id="commands">Commands</h2>
<p>Run production build (default)</p>
<pre><code>xt-build
</code></pre>

<p>Run production build using explicit flag</p>
<pre><code>xt-build -e prod
</code></pre>

<p>Run development build</p>
<pre><code>xt-build -e dev
</code></pre>

<p>Command using custom configuration file path</p>
<pre><code>xt-build --config &quot;/path/to/config.json&quot;
</code></pre>

<p>Run development build and keep watching changes</p>
<pre><code>xt-build -e dev --watch
</code></pre>

<p>Get help using this command</p>
<pre><code>xt-build --help
</code></pre>

<p>After installing extension-cli, you can run these commands from a terminal using syntax <code>npx xt-build</code>.</p>
<p>Or you can add an option to <code>packages.json</code> scripts section (see example below) and then execute the command as <code>npm run build</code> or <code>npm run start</code>.</p>
<pre><code>&quot;scripts&quot;:{
    &quot;start&quot;: &quot;xt-build -e dev -w&quot;,
    &quot;build&quot;: &quot;xt-build -e prod&quot;,
}
</code></pre>

<p><br/></p>
<h2 id="build-configuration">Build Configuration</h2>
<p>By default the CLI will look for build configuration in two different
places:
- in <code>package.json</code> using key <code>xtbuild</code>
- in a file named <code>.xtbuild.json</code> in project root</p>
<p>If these two locations cause a conflict, alternatively you can provide a path to configuration file with <code>--config</code> (<code>-c</code>) flag,
 followed by path to file. <a href="#commands">See commands for an example</a>.</p>
<p>The CLI uses a default build configuration file shown below. This tells the extension CLI where to look for files and where to output files. You can override any of these key-value pairs at project level. You can find more detailed explanations of usage of some of these keys <a href="#custom-configurations">below</a>.</p>
<pre><code class="json">{
  &quot;projectRootDir&quot;: &quot;../../../&quot;,
  &quot;dist&quot;: &quot;./dist&quot;,
  &quot;source&quot;: &quot;./src&quot;,
  &quot;releases&quot;: &quot;./&quot;,
  &quot;manifest&quot;: &quot;./src/manifest.json&quot;,
  &quot;js&quot;: &quot;./src/**/*.js&quot;,
  &quot;js_bundles&quot;: null,
  &quot;html&quot;: &quot;./src/**/*.html&quot;,
  &quot;scss&quot;: &quot;./src/**/*.scss&quot;,
  &quot;scss_bundles&quot;: null,
  &quot;icons&quot;:[
    &quot;./assets/img/**/*.png&quot;,
    &quot;./assets/img/**/*.gif&quot;,
    &quot;./assets/img/**/*.jpg&quot;,
    &quot;./assets/img/**/*.svg&quot;
  ],
  &quot;copyAsIs&quot;: [],
  &quot;locales_dir&quot;: &quot;./assets/locales/&quot;,
  &quot;locales_list&quot;: [&quot;en&quot;]
}
</code></pre>

<p><br/></p>
<h2 id="custom-configurations">Custom Configurations</h2>
<h3 id="script-bundles">Script Bundles</h3>
<p><code>js_bundles</code> key used to configure build settings for javascript bundles. You will need to configure
bundles when your compiled extension contains more than 1 javascript file. </p>
<p>The expected value for <code>js_bundles</code> is an array with one or more items as shown in the example below.</p>
<ul>
<li><code>name</code> is the output bundle filename without file extension</li>
<li><code>src</code> specifies which files to include in each bundle; you can use a string value for a single file,  array of files, or a path with wildcard. You may also use <code>!</code> as a way to negate the inclusion of a file. This is the <a href="https://gulpjs.com/docs/en/api/src">globs syntax expected by gulp</a> (without options).</li>
</ul>
<h4 id="example">Example</h4>
<p>Sample project-level configuration with multiple javascript bundles</p>
<pre><code>  &quot;xtbuild&quot;: {
    &quot;js_bundles&quot;: [
      {
        &quot;name&quot;: &quot;background&quot;,
        &quot;src&quot;: &quot;./src/background.js&quot;
      },
      {
        &quot;name&quot;: &quot;app&quot;,
        &quot;src&quot;: [
            &quot;./src/app/inbox/**/*.js&quot;,
            &quot;./src/app/message/**/*.js&quot;
         ]
      }
    ]
  }
</code></pre>

<h3 id="skip-javascript-compilation-and-linting">Skip Javascript Compilation and Linting</h3>
<p>Use <code>copyAsIs</code> key to specify an array of files which should not be compiled. These files can be located anywhere in your project. The build command will copy specified files exactly without any modification to the root of the output directory. Any path will be flattened.</p>
<h4 id="example_1">Example</h4>
<p>Sample configuration for skipping compilation of pre-compiled files</p>
<pre><code>  &quot;xtbuild&quot;: {
    &quot;copyAsIs&quot;: [
      &quot;./node_modules/material-design-lite/material.min.js&quot;,
      &quot;./assets/ga.js&quot;
    ]
  }
</code></pre>

<p>In the project-level <code>package.json</code>, add the file paths to the list of ignored files
to prevent them from being linted.</p>
<pre><code class="json">  {  
      &quot;eslintIgnore&quot;: [
        &quot;test/**/*&quot;,
        &quot;./assets/ga.js&quot;
      ]
  }
</code></pre>

<h3 id="style-bundles">Style bundles</h3>
<p><code>scss_bundles</code> are used to configure build settings for css-style files. The expected value is an array with one or more items as shown in the example below.</p>
<ul>
<li>The property value <code>name</code> is the output bundle filename with file extension</li>
<li><code>src</code> specifies which files to include in each bundle; you can use a string value for a single file,  array of files, or a path with wildcard. You may also use <code>!</code> as a way to negate the inclusion of a file. This is the <a href="https://gulpjs.com/docs/en/api/src">globs syntax expected by gulp</a> (without options).</li>
</ul>
<p>When using production build the style files will be minified. Dev build does not minify style files.</p>
<p>By default, the stylesheets are assumed to be written using <a href="https://sass-lang.com/guide">Sass</a>. If you are not a friend of Sass language stylesheets, you can write your style sheets using regular CSS. However name your files using <code>.scss</code> file extension, or override the default configuration: <code>"scss": "./src/**/*.scss",</code> because this means the CLI will by default only look for <code>.scss</code> style files.</p>
<h4 id="example_2">Example</h4>
<p>Sample project-level configuration with multiple style bundles</p>
<pre><code>  &quot;xtbuild&quot;: {
    &quot;scss_bundles&quot;: [
      {
        &quot;src&quot;: [
          &quot;./src/**/*.scss&quot;,
          &quot;!./src/app/styles/message.scss&quot;
        ],
        &quot;name&quot;: &quot;styles.css&quot;
      },
      {
        &quot;src&quot;: [
          &quot;./src/app/styles/message.scss&quot;
        ],
        &quot;name&quot;: &quot;display.css&quot;
      }
    ]
  }
</code></pre>

<h3 id="localization">Localization</h3>
<p>If the extension supports multiple languages, specify all supported languages using key <code>locales_list</code>. The default language value is <code>["en"]</code>. </p>
<p>This <code>locales_list</code> should be an array that corresponds to a list of subdirectories under <code>locales_dir</code> in the extension project. The default <code>locales_dir</code> is <code>./assets/locales/</code>, which you may change if you want.</p>
<p>Refer <a href="https://developers.google.com/admin-sdk/directory/v1/languages">to this list of language codes</a> when naming individual language directories.</p>
<h4 id="example_3">Example</h4>
<p>Multiple locales example with custom path to locales files</p>
<pre><code>  &quot;xtbuild&quot;: {
      &quot;locales_dir&quot;: &quot;./my/custom/locales/path/&quot;,
      &quot;locales_list&quot;: [&quot;en&quot;,&quot;en-GB&quot;,&quot;pl&quot;]
  }
</code></pre>

<p><br/></p>
<p>Given the configuration above, the following project-level directories are expected. </p>
<p><br/></p>
<table>
<thead>
<tr>
<th>File Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>└ <strong><code>/my/custom/locales/path/</code></strong></td>
<td>path to locales</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; └─ <code>en</code>/messages.json</td>
<td>Default English dictionary</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; └─ <code>en-GB</code>/messages.json</td>
<td>British dictionary</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; └─ <code>pl/</code></td>
<td>Polish language dictionaries</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └─ app.json</td>
<td>Polish language dictionaries</td>
</tr>
<tr>
<td>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; └─ options.json</td>
<td>Polish language dictionaries</td>
</tr>
</tbody>
</table>
<p>You can break down your locales files into multiple <code>.json</code> files within the language-specific directory as shown in the example above for <code>pl/</code>. This may make the maintenance locales files easier if the files contain multiple entries. The build step will automatically combine all files within a language directory into a single <code>messages.json</code> which is expected from browser extensions.</p>
<h3 id="image-assets">Image Assets</h3>
<p>By default extension CLI will look for image assets from the following paths:</p>
<pre><code>&quot;icons&quot;: [
    &quot;./assets/img/**/*.png&quot;,
    &quot;./assets/img/**/*.gif&quot;,
    &quot;./assets/img/**/*.jpg&quot;,
    &quot;./assets/img/**/*.svg&quot;
  ],
</code></pre>

<p>You may change this configuration if the project image assets are located elsewhere or
if you want to support additional image file extensions.</p>
<p>After the build step, all image assets will be located in the <code>/dist/icons</code> directory.
Therefore, in your extension project <code>manifest.json</code> you would refer to them as follows:</p>
<pre><code>  &quot;browser_action&quot;: {
    &quot;default_icon&quot;: {
      &quot;16&quot;: &quot;icons/16x16.png&quot;,
      &quot;24&quot;: &quot;icons/24x24.png&quot;,
      &quot;32&quot;: &quot;icons/32x32.png&quot;
    }
  }
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../xt-clean/" class="btn btn-neutral float-right" title="xt-clean">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../configuration/" class="btn btn-neutral" title="Configuration"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../configuration/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../xt-clean/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://buttons.github.io/buttons.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
